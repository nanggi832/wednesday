<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iloom 3D Artwork Cost</title>
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Pretendard', -apple-system, sans-serif;
    background: #ccc8c0;
    min-height: 100vh;
    padding: 52px 40px;
  }
  .container { max-width: 1100px; margin: 0 auto; }
  h1 { font-size: 26px; font-weight: 700; margin-bottom: 3px; letter-spacing: -0.5px; color: #1a1a1a; }
  .subtitle { font-size: 12px; color: #999; margin-bottom: 22px; }

  .table-outer { border-radius: 14px; box-shadow: 0 2px 24px rgba(0,0,0,0.13); }
  .table-wrap { background: #fff; border-radius: 14px; overflow: visible; }
  .row.hd { border-radius: 14px 14px 0 0; }
  .row.add { border-radius: 0 0 14px 14px; }

  /* cols: check(48) | í•­ëª©(1fr) | ë‚œì´ë„(80px) | ê¸°ê°„(240px) | ìˆ˜ëŸ‰(200px) | ë‹¨ê°€(150px) */
  .row {
    display: grid;
    grid-template-columns: 48px 1fr 80px 240px 200px 150px;
    align-items: center;
    border-bottom: 1px solid #eeebe5;
    min-height: 56px;
  }
  .row:last-child { border-bottom: none; }
  .row:hover:not(.hd):not(.total):not(.sec):not(.add) { background: #faf8f4; }
  .row.on { background: #f7f3ed; }

  .row.hd { background: #f5f2ec; min-height: 38px; border-bottom: 1px solid #e8e4dc; }
  .row.hd .c { font-size: 11px; color: #aaa49c; font-weight: 500; justify-content: center; }
  .row.hd .c.hd-name { justify-content: flex-start; padding-left: 16px; }

  /* ëŒ€ë¶„ë¥˜ ì„¹ì…˜ í—¤ë” */
  .row.sec-main {
    background: #e8e2d8;
    min-height: 32px;
    border-bottom: 1px solid #d8d0c4;
  }
  .row.sec-main .c {
    font-size: 11px; font-weight: 700; color: #7a6a58;
    letter-spacing: 0.3px; padding-left: 16px; justify-content: flex-start;
    grid-column: 1/-1;
  }

  .row.total { background: #1a1714; min-height: 58px; border-bottom: none; }
  .row.add { min-height: 40px; cursor: pointer; border-bottom: none; }
  .row.add:hover { background: #f5f2ec; }
  .row.add .c { font-size: 12px; color: #bbb5ac; padding-left: 18px; justify-content: flex-start; }

  .c { padding: 0 16px; display: flex; align-items: center; }
  .c.mid { justify-content: center; }

  input[type=checkbox] { display: none; }
  .chk {
    width: 17px; height: 17px; border-radius: 4px; border: 1.5px solid #cdc8c0;
    background: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: all .15s; flex-shrink: 0;
  }
  .chk:hover { border-color: #9a8a78; }
  input[type=checkbox]:checked + .chk { background: #7a6a58; border-color: #7a6a58; }
  input[type=checkbox]:checked + .chk::after {
    content: ''; width: 9px; height: 5px;
    border-left: 2px solid #fff; border-bottom: 2px solid #fff;
    transform: rotate(-45deg) translateY(-1px); display: block;
  }

  .iname { display: flex; align-items: center; gap: 6px; font-size: 13px; font-weight: 500; color: #2a2520; white-space: nowrap; overflow: hidden; }
  .ico { font-size: 14px; flex-shrink: 0; }
  /* ì†Œë¶„ë¥˜ ë“¤ì—¬ì“°ê¸° */
  .iname.sub { padding-left: 10px; color: #6a5e52; font-size: 12px; }
  .iname.sub::before { content: 'â””'; color: #c0b8ae; font-size: 11px; flex-shrink: 0; }

  .abtn {
    background: none; border: none; font-family: inherit; cursor: pointer;
    font-size: 14px; color: #c8c2b8; line-height: 1; padding: 0 2px; flex-shrink: 0;
    transition: color .12s;
  }
  .abtn:hover { color: #7a6a58; }
  .abtn.rm:hover { color: #c86858; }

  .lvs { display: flex; gap: 2px; }
  .lv {
    padding: 2px 5px; border-radius: 4px;
    border: 1.5px solid #ddd8d0; background: #fff;
    font-size: 10px; font-weight: 600; color: #c0b8ae;
    cursor: pointer; font-family: inherit; transition: all .12s; line-height: 1.5;
  }
  .lv:hover { border-color: #a89880; color: #7a6a58; }
  .lv.on { background: #7a5c3a; border-color: #7a5c3a; color: #fff; }

  .sqs { display: flex; gap: 4px; }
  .sq { width: 17px; height: 17px; border-radius: 3px; background: #d8d2c8; transition: background .2s; }
  .sq.on { background: #7a6a58; }

  /* ì»¤ìŠ¤í…€ ë“œë¡­ë‹¤ìš´ */
  .dd-wrap { position: relative; width: 158px; user-select: none; }
  .dd-btn {
    width: 158px; height: 32px;
    border: 1.5px solid #d8d2c8; border-radius: 9px;
    padding: 0 28px 0 12px;
    font-size: 12px; font-weight: 500; font-family: inherit;
    color: #a89888; background: #fff;
    cursor: pointer; display: flex; align-items: center;
    transition: border-color .15s; position: relative;
  }
  .dd-btn::after {
    content: ''; position: absolute; right: 10px; top: 50%;
    transform: translateY(-50%);
    width: 0; height: 0;
    border-left: 4px solid transparent; border-right: 4px solid transparent;
    border-top: 5px solid #b0a090; transition: transform .2s;
  }
  .dd-btn.ok { color: #3a2e22; border-color: #a89070; font-weight: 600; }
  .dd-btn.open { border-color: #9a8870; border-radius: 9px 9px 0 0; }
  .dd-btn.open::after { transform: translateY(-50%) rotate(180deg); }
  .dd-list {
    display: none; position: absolute; top: 100%; left: 0; width: 158px;
    background: #fff; border: 1.5px solid #9a8870; border-top: none;
    border-radius: 0 0 9px 9px; overflow: hidden; z-index: 999;
    box-shadow: 0 6px 18px rgba(0,0,0,0.10);
  }
  .dd-list.open { display: block; }
  .dd-item {
    padding: 8px 12px; font-size: 12px; font-weight: 500; font-family: inherit;
    color: #6a5e52; cursor: pointer; border-bottom: 1px solid #eeebe5; transition: background .1s;
  }
  .dd-item:last-child { border-bottom: none; }
  .dd-item:hover { background: #f7f3ed; }
  .dd-item.selected { color: #3a2e22; font-weight: 700; background: #f2eeea; }

  .ctr { display: flex; align-items: center; gap: 7px; width: 158px; }
  .cbtn {
    width: 28px; height: 28px; border-radius: 7px; border: 1.5px solid #d8d2c8;
    background: #fff; cursor: pointer; font-size: 13px; font-family: inherit; color: #a89888;
    display: flex; align-items: center; justify-content: center; transition: all .12s; flex-shrink: 0;
  }
  .cbtn:hover { border-color: #9a8870; color: #7a6a58; }
  .ctag {
    flex: 1; padding: 5px 0; border-radius: 7px; font-size: 12px; font-weight: 600;
    background: #eee8e0; color: #8a7868; text-align: center;
  }

  .price { font-size: 13px; color: #4a3e32; font-feature-settings: "tnum"; }

  .row.total .c { justify-content: center; }
  .tot-lbl { font-size: 14px; color: #fff; font-weight: 700; }
  .tot-val { font-size: 15px; color: #c0a888; font-weight: 700; }
</style>
</head>
<body>
<div class="container">
  <h1>iloom 3D Artwork Cost</h1>
  <p class="subtitle">ì œí’ˆ 1ì¢… ê¸°ì¤€</p>
  <div class="table-outer">
    <div class="table-wrap">

      <div class="row hd">
        <div class="c"></div>
        <div class="c hd-name">í•­ëª©</div>
        <div class="c mid">ë‚œì´ë„</div>
        <div class="c mid">ê¸°ê°„</div>
        <div class="c mid">ìˆ˜ëŸ‰</div>
        <div class="c mid">ë‹¨ê°€</div>
      </div>

      <!-- â‘  ì œí’ˆ 3D ëª¨ë¸ë§ -->
      <div class="row sec-main"><div class="c">ğŸ›‹ï¸ ì œí’ˆ 3D ëª¨ë¸ë§</div></div>
      <div id="mRows"></div>

      <!-- â‘¡ ì œí’ˆ ë Œë” -->
      <div class="row sec-main"><div class="c">ğŸ–¼ï¸ ì œí’ˆ ë Œë”</div></div>
      <div id="renderRows"></div>

      <!-- â‘¢ ë””í…Œì¼ ì»· -->
      <div class="row sec-main"><div class="c">ğŸ” ë””í…Œì¼ ì»·</div></div>
      <div id="detailRows"></div>

      <!-- â‘£ ìŠ¤íƒ€ì¼ ì»· -->
      <div class="row sec-main"><div class="c">â­ ìŠ¤íƒ€ì¼ ì»·</div></div>
      <div id="styleRows"></div>

      <!-- â‘¤ ì• ë‹ˆë©”ì´ì…˜ -->
      <div class="row sec-main"><div class="c">ğŸ¬ ì• ë‹ˆë©”ì´ì…˜</div></div>
      <div id="aniRows"></div>

      <div class="row total" id="totRow"></div>
      <div class="row add"><div class="c" style="grid-column:1/-1">ï¼‹ í•­ëª© ì¶”ê°€</div></div>
    </div>
  </div>
</div>

<script>
// â”€â”€ ì œí’ˆ 3D ëª¨ë¸ë§ ë“œë¡­ë‹¤ìš´ íƒ€ì… â”€â”€
const MTYPES = [
  {label:'ëª¨ë¸ë§ ìœ í˜•',  days:0, price:0},
  {label:'ëª¨ë¸ë§ (ìƒ)',  days:9, price:500000},
  {label:'ëª¨ë¸ë§ (ì¤‘)',  days:6, price:250000},
  {label:'ëª¨ë¸ë§ (í•˜)',  days:3, price:100000},
  {label:'ì‚¬ì´ì¦ˆ/êµ¬ì„±',  days:2, price:100000},
];

const LVS = ['ìƒ','ì¤‘','í•˜'];

// â”€â”€ ê° ì„¹ì…˜ ê¸°ë³¸ í•­ëª© â”€â”€
const DEF_RENDER = [
  {id:101, name:'ì œí’ˆ ë‹¨í’ˆì»·',      ico:'ğŸª‘', cut:1, price:150000, days:2, lv:1, def:true},
  {id:102, name:'ì œí’ˆ (ì•µê¸€,ì»¬ëŸ¬)', ico:'ğŸ”„', cut:1, price: 50000, days:1, lv:1, def:true},
  {id:104, name:'ë§ˆê°ì¬ ë³€ê²½',      ico:'ğŸ¨', cut:1, price:100000, days:3, lv:1, def:true},
];
const DEF_DETAIL = [
  {id:201, name:'ë””í…Œì¼ì»·',  ico:'ğŸ”', cut:1, price:250000, days:4, lv:0, def:true},
  
  {id:203, name:'ë§ˆê°ì¬ êµì²´',   ico:'ğŸ”', cut:1, price: 50000, days:1, lv:1, def:true},
];
const DEF_STYLE = [
  {id:301, name:'ë©”ì¸ì»·',               ico:'ğŸ ', cut:1, price:700000, days:9, lv:0, def:true},
  {id:304, name:'ë©”ì¸ì»· (ì•µê¸€/ë¼ì´íŒ…)', ico:'ğŸŒƒ', cut:1, price:150000, days:2, lv:1, def:true},
  {id:305, name:'ë©”ì¸ì»· (ë¼ì´í”„ìŠ¤íƒ€ì¼)',ico:'ğŸ±', cut:1, price:100000, days:2, lv:1, def:true},
];
const DEF_ANI = [
  {id:401, name:'ì•„ì´ì½”ë‹‰ ì˜ìƒ',   ico:'ğŸ¬', cut:1, price:7000000, days:9, lv:0, def:true},
  {id:404, name:'ê³µê°„ë¬´ë“œ ì˜ìƒ',   ico:'ğŸ“½ï¸', cut:1, price:5000000, days:7, lv:1, def:true},
  {id:405, name:'ê¸°ì¡´ ì»· í¸ì§‘',    ico:'âœ‚ï¸', cut:1, price: 500000, days:2, lv:1, def:true},
  {id:406, name:'USP ë””í…Œì¼ í´ë¦½', ico:'ğŸ“²', cut:1, price:1500000, days:3, lv:1, def:true},
];

function load(){try{const s=localStorage.getItem('iloom_v13');if(s)return JSON.parse(s);}catch(e){}return null;}
function save(){try{localStorage.setItem('iloom_v13',JSON.stringify({M,R,D,S,A,mc,ic}));}catch(e){}}

const sv = load();
let M  = sv?sv.M : [{id:1,ti:0,checked:false}];
let R  = sv?sv.R : DEF_RENDER.map(f=>({...f,checked:false}));
let D  = sv?sv.D : DEF_DETAIL.map(f=>({...f,checked:false}));
let S  = sv?sv.S : DEF_STYLE.map(f=>({...f,checked:false}));
let A  = sv?sv.A : DEF_ANI.map(f=>({...f,checked:false}));
let mc = sv?sv.mc: 2;
let ic = sv?sv.ic: 500;

const fmt = n => n.toLocaleString('ko-KR')+'ì›';
const sqs = n => Array.from({length:9},(_,i)=>`<div class="sq${i<n?' on':''}"></div>`).join('');

// â”€â”€ ì»¤ìŠ¤í…€ ë“œë¡­ë‹¤ìš´ â”€â”€
document.addEventListener('click', e=>{
  if(!e.target.closest('.dd-wrap')) closeAllDd();
});
function closeAllDd(){
  document.querySelectorAll('.dd-list.open').forEach(el=>el.classList.remove('open'));
  document.querySelectorAll('.dd-btn.open').forEach(el=>el.classList.remove('open'));
}
function toggleDd(id){
  const btn=document.getElementById('ddb-'+id);
  const lst=document.getElementById('ddl-'+id);
  if(!btn||!lst)return;
  const was=lst.classList.contains('open');
  closeAllDd();
  if(!was){btn.classList.add('open');lst.classList.add('open');}
}
function selectDd(mId,ti){
  const m=M.find(x=>x.id===mId); if(m){m.ti=ti;}
  closeAllDd(); render();
}
function makeDd(m){
  const t=MTYPES[m.ti]; const ok=m.ti>0;
  return `<div class="dd-wrap">
    <div class="dd-btn${ok?' ok':''}" id="ddb-${m.id}" onclick="toggleDd(${m.id});event.stopPropagation()">${t.label}</div>
    <div class="dd-list" id="ddl-${m.id}">
      ${MTYPES.map((o,i)=>`<div class="dd-item${m.ti===i?' selected':''}" onclick="selectDd(${m.id},${i})">${o.label}</div>`).join('')}
    </div></div>`;
}

// â”€â”€ ëª¨ë¸ë§ ë Œë” â”€â”€
function renderM(){
  const w=document.getElementById('mRows'); w.innerHTML='';
  M.forEach((m,idx)=>{
    const t=MTYPES[m.ti], row=document.createElement('div');
    row.className='row'+(m.checked?' on':'');
    row.innerHTML=`
      <div class="c mid"><label style="cursor:pointer"><input type="checkbox" ${m.checked?'checked':''} onchange="chkM(${m.id},this.checked)"><span class="chk"></span></label></div>
      <div class="c"><div class="iname">
        ${idx===0?`<button class="abtn" onclick="addM()">ï¼‹</button>`:`<button class="abtn rm" onclick="delM(${m.id})">ï¼</button>`}
        <span class="ico">ğŸ“¦</span>ì œí’ˆ 3D ëª¨ë¸ë§
      </div></div>
      <div class="c mid"></div>
      <div class="c mid"><div class="sqs">${sqs(t.days)}</div></div>
      <div class="c mid">${makeDd(m)}</div>
      <div class="c mid">${t.price>0?`<span class="price">${fmt(t.price)}</span>`:''}</div>`;
    w.appendChild(row);
  });
}

// â”€â”€ ì¼ë°˜ í•­ëª© ë Œë” (ì œí’ˆë Œë”/ë””í…Œì¼ì»·/ìŠ¤íƒ€ì¼ì»·/ì• ë‹ˆë©”ì´ì…˜) â”€â”€
function renderSection(arr, elId, setFns){
  const w=document.getElementById(elId); w.innerHTML='';
  arr.forEach(item=>{
    const row=document.createElement('div');
    row.className='row'+(item.checked?' on':'');
    const lvBtns=LVS.map((l,li)=>
      `<button class="lv${item.lv===li?' on':''}" onclick="${setFns.lv}(${item.id},${li})">${l}</button>`
    ).join('');
    const btn=item.def
      ?`<button class="abtn" onclick="${setFns.clone}(${item.id})">ï¼‹</button>`
      :`<button class="abtn rm" onclick="${setFns.del}(${item.id})">ï¼</button>`;
    const isSub = item.name.startsWith('â””');
    row.innerHTML=`
      <div class="c mid"><label style="cursor:pointer"><input type="checkbox" ${item.checked?'checked':''} onchange="${setFns.chk}(${item.id},this.checked)"><span class="chk"></span></label></div>
      <div class="c"><div class="iname${isSub?' sub':''}">
        ${btn}<span class="ico">${item.ico}</span>${item.name}
      </div></div>
      <div class="c mid"><div class="lvs">${lvBtns}</div></div>
      <div class="c mid"><div class="sqs">${sqs(item.days)}</div></div>
      <div class="c mid">
        <div class="ctr">
          <button class="cbtn" onclick="${setFns.cut}(${item.id},-1)">ï¼</button>
          <span class="ctag">${item.cut}ì»·</span>
          <button class="cbtn" onclick="${setFns.cut}(${item.id},1)">ï¼‹</button>
        </div>
      </div>
      <div class="c mid"><span class="price">${fmt(item.price)}</span></div>`;
    w.appendChild(row);
  });
}

function renderTot(){
  const r=document.getElementById('totRow');
  let tc=0,tp=0;
  [...R,...D,...S,...A].forEach(i=>{if(i.checked){tc+=i.cut;tp+=i.cut*i.price;}});
  M.forEach(m=>{if(m.checked&&MTYPES[m.ti].price>0){tp+=MTYPES[m.ti].price;}});
  r.innerHTML=`
    <div class="c"></div>
    <div class="c" style="justify-content:center"><span class="tot-lbl">í•©ê³„</span></div>
    <div class="c"></div><div class="c"></div>
    <div class="c" style="justify-content:center"><span class="tot-val">${tc}ì»·</span></div>
    <div class="c" style="justify-content:center"><span class="tot-val">${fmt(tp)}</span></div>`;
}

function render(){
  renderM();
  renderSection(R,'renderRows',{lv:'lvR',clone:'cloneR',del:'delR',chk:'chkR',cut:'cutR'});
  renderSection(D,'detailRows',{lv:'lvD',clone:'cloneD',del:'delD',chk:'chkD',cut:'cutD'});
  renderSection(S,'styleRows', {lv:'lvS',clone:'cloneS',del:'delS',chk:'chkS',cut:'cutS'});
  renderSection(A,'aniRows',   {lv:'lvA',clone:'cloneA',del:'delA',chk:'chkA',cut:'cutA'});
  renderTot();
  save();
}

// â”€â”€ ëª¨ë¸ë§ í•¸ë“¤ëŸ¬ â”€â”€
function addM(){M.push({id:mc++,ti:0,checked:false});render();}
function delM(id){M=M.filter(m=>m.id!==id);render();}
function chkM(id,v){const m=M.find(m=>m.id===id);if(m){m.checked=v;render();}}

// â”€â”€ ì„¹ì…˜ë³„ í•¸ë“¤ëŸ¬ ìƒì„± â”€â”€
function makeHandlers(arr, prefix){
  window[`lv${prefix}`]    = (id,lv)=>{const i=arr.find(x=>x.id===id);if(i){i.lv=lv;render();}};
  window[`chk${prefix}`]   = (id,v) =>{const i=arr.find(x=>x.id===id);if(i){i.checked=v;render();}};
  window[`cut${prefix}`]   = (id,d) =>{const i=arr.find(x=>x.id===id);if(i){i.cut=Math.max(1,i.cut+d);render();}};
  window[`del${prefix}`]   = (id)   =>{arr.splice(arr.findIndex(x=>x.id===id),1);render();};
  window[`clone${prefix}`] = (sid)  =>{
    const src=arr.find(x=>x.id===sid);if(!src)return;
    const idx=arr.findIndex(x=>x.id===sid);
    arr.splice(idx+1,0,{...src,id:ic++,def:false});render();
  };
}
makeHandlers(R,'R');
makeHandlers(D,'D');
makeHandlers(S,'S');
makeHandlers(A,'A');

render();
</script>
</body>
</html>
